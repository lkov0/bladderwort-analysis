genePairs <- read.table("~/Dropbox/Bladderwort/0_Data/New_Genome/u.gibba_NEW.genePairs.txt", header=T, sep="\t")
head(genePairs)
fpkms <- read.table("~/Dropbox/Bladderwort/2_Cufflinks/SRR768657_U.gibba_NEW/genes.fpkm_tracking", header=T, sep="\t")
head(fpkms)
head(genePairs)
genePairs$tracking_id1 <-  gsub("ID=", "", genePairs$geneId1)
genePairs$tracking_id2 <- gsub("ID=", "", genePairs$geneId2)
fpkms$tracking_id1 <- fpkms$tracking_id
fpkms$tracking_id2 <- fpkms$tracking_id
head(fpkms)
head(genePairs)
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,14)], by="tracking_id1")
head(genePairs.fpkms)
names(genePairs.fpkms$FPKM)
col.names(genePairs.fpkms$FPKM)
colnames(genePairs.fpkms$FPKM)
names(genePairs.fpkms$FPKM)
names(genePairs.fpkms)
names(genePairs.fpkms)[15] <- FPKM1
names(genePairs.fpkms)[15] <- "FPKM1"
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,14)], by="tracking_id1")
names(genePairs.fpkms)[15] <- "FPKM1"
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,15)], by="tracking_id2")
names(genePairs.fpkms)[16] <- "FPKM2"
genePairs <- read.table("~/Dropbox/Bladderwort/0_Data/New_Genome/u.gibba_NEW.genePairs.txt", header=T, sep="\t")
genePairs$tracking_id1 <-  gsub("ID=", "", genePairs$geneId1)
genePairs$tracking_id2 <- gsub("ID=", "", genePairs$geneId2)
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,14)], by="tracking_id1")
names(genePairs.fpkms)[15] <- "FPKM1"
names(genePairs.fpkms)
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,15)], by="tracking_id2")
names(genePairs.fpkms)
genePairs.fpkms <- merge(genePairs.fpkms, fpkms[,c(10,15)], by="tracking_id2")
names(genePairs.fpkms)[16] <- "FPKM2"
names(genePairs.fpkms)
genePairs.fpkms <- merge(genePairs, fpkms[,c(10,14)], by="tracking_id1")
head(genePairs.fpkms)
names(genePairs.fpkms)[15] <- "FPKM1"
genePairs.fpkms <- merge(genePairs.fpkms, fpkms[,c(10,15)], by="tracking_id2")
head(genePairs.fpkms)
names(genePairs.fpkms)[16] <- "FPKM2"
head(genePairs.fpkms)
genePairs.fpkms$foldChange <- (genePairs$FPKM1 - genePairs$FPKM2) / genePairs$FPKM2
genePairs.fpkms$foldChange <- (genePairs.fpkms$FPKM1 - genePairs.fpkms$FPKM2) / genePairs.fpkms$FPKM2
head(genePairs.fpkms)
genePairs.fpkms$foldChange <- ifelse(genePairs$FPKM1 == 0 | genePairs$FPKM2 == 0, "NA",(genePairs.fpkms$FPKM1 - genePairs.fpkms$FPKM2) / genePairs.fpkms$FPKM2)
genePairs.fpkms$foldChange <- ifelse(genePairs.fpkms$FPKM1 == 0 | genePairs.fpkms$FPKM2 == 0, "NA",(genePairs.fpkms$FPKM1 - genePairs.fpkms$FPKM2) / genePairs.fpkms$FPKM2)
head(genePairs)
head(genePairs.fpkms)
genePairs.fpkms$foldChange <- ifelse(genePairs.fpkms$FPKM1 == 0 | genePairs.fpkms$FPKM2 == 0, "NA",abs((genePairs.fpkms$FPKM1 - genePairs.fpkms$FPKM2) / genePairs.fpkms$FPKM2))
head(genePairs.fpkms)
max(genePairs.fpkms$foldChange)
genePairs.fpkms$foldChange
as.integer(genePairs.fpkms$foldChange)
as.numeric(genePairs.fpkms$foldChange)
as.numeric(genePairs.fpkms$foldChange)
genePairs.fpkms$foldChange <- ifelse(genePairs.fpkms$FPKM1 == 0 | genePairs.fpkms$FPKM2 == 0, NA ,abs((genePairs.fpkms$FPKM1 - genePairs.fpkms$FPKM2) / genePairs.fpkms$FPKM2))
head(genePairs)
head(genePairs.fpkms)
max(genePairs.fpkms)
max(subset(genePairs.fpkms, !(is.na(foldChange)))
)
subset(genePairs.fpkms, !(is.na(foldChange))))
subset(genePairs.fpkms, !(is.na(foldChange)))
max(subset(genePairs.fpkms, !(is.na(foldChange)))$foldChange)
write.table(subset(genePairs.fpkms, !(is.na(foldChange))), file=args$outputFile, row.names=F, col.names=T, quote=F, sep="\t")
genePairs.fpkms <- subset(genePairs.fpkms, !(is.na(foldChange)))
nrow(genePairs.fpkms)
table(genePairs.fpkms$orientation)
hist(subset(genePairs.fpkms, orientation==parallel)$foldChange)
hist(subset(genePairs.fpkms, orientation=="parallel")$foldChange)
hist(subset(genePairs.fpkms, orientation=="convergent")$foldChange)
hist(subset(genePairs.fpkms, orientation=="divergent")$foldChange)
boxplot(genePairs.fpkms$foldChange ~ genePairs.fpkms$foldChange)
boxplot(genePairs.fpkms$foldChange ~ genePairs.fpkms$orientation)
boxplot(genePairs.fpkms$foldChange ~ genePairs.fpkms$orientation, ylim=c(0,1000))
boxplot(genePairs.fpkms$foldChange ~ genePairs.fpkms$orientation, ylim=c(0,1000), main="expressed gene pairs - fold change", ylab="Fold change", xlab="orientation")
quit()
newRNAdataset <- read.table("~/Dropbox/Bladderwort/0_Data/New_Genome/SRR768657_u.gibba_NEW.genePairs.foldChange.txt", header=T, sep="\t")
oldRNAdataset <- read.table("~/Dropbox/Bladderwort/0_Data/New_Genome/SRR094438_u.gibba_OLD.genePairs.foldChange.txt", head
)
quit()
oldGenome.newRNA <- read.table("~/Dropbox/Bladderwort/3_Analysis/SRR768657_u.gibba_NEW.genePairs.foldChange.txt", header=T, sep="\t")
head(oldGenome.newRNA)
oldGenome.newRNA <- read.table("~/Dropbox/Bladderwort/3_Analysis/SRR768657_u.gibba_OLD.genePairs.foldChange.txt", header=T, sep="\t")
head(oldGenome.newRNA)
nrow(subset(oldGenome.newRNA, distance < 1500 & foldChange > 10)) 
head(subset(oldGenome.newRNA, distance < 1500 & foldChange > 10)) 
head(subset(oldGenome.newRNA, distance < 1500 & foldChange > 10 & orientation = "divergent")) 
head(subset(oldGenome.newRNA, distance < 1500 & foldChange > 10 & orientation == "divergent")) 
nrow(subset(oldGenome.newRNA, distance < 1500 & foldChange > 10 & orientation == "divergent")) 
oldGenome.oldRNA <- read.table("~/Dropbox/Bladderwort/3_Analysis/SRR094438__u.gibba_OLD.genePairs.foldChange.txt", header=T, sep="\t")
oldGenome.oldRNA <- read.table("~/Dropbox/Bladderwort/3_Analysis/SRR094438_u.gibba_OLD.genePairs.foldChange.txt", header=T, sep="\t")
nrow(subset(oldGenome.newRNA, distance < 1000 & foldChange > 100))
nrow(subset(oldGenome.oldRNA, distance < 1000 & foldChange > 100))
candidates.oldRNA <- nrow(subset(oldGenome.oldRNA, distance < 1000 & foldChange > 100))
candidates.oldRNA <- subset(oldGenome.oldRNA, distance < 1000 & foldChange > 100)
candidates.newRNA <- subset(oldGenome.newRNA, distance < 1000 & foldChange > 100)
nrow(candidates.newRNA)
head(candidates.newRNA)
candidates.newRNA$pairID <- paste(candidates.newRNA$tracking_id1, candidates.newRNA$tracking_id2, sep="")
candidates.oldRNA$pairID <- paste(candidates.oldRNA$tracking_id1, candidates.oldRNA$tracking_id2, sep="")
nrow(candidates.newRNA)
nrow(subset(candidates.oldRNA, !(pairID %in% candidates.newRNA$pairID)))
nrow(candidates.oldRNA)
quit()
